<html>
<head>
    <!-- For debug messages, include debug.js and set localStorage.debug = 'StreamrClient'. See from https://github.com/visionmedia/debug -->
    <script src="../../dist/streamr-client.web.js"></script>
    <!-- Or use unpkg, e.g. https://unpkg.com/browse/streamr-client@4.1.6/dist/streamr-client.web.js -->

    <script>
        const log = (msg) => {
            var elem = document.createElement('p')
            elem.innerHTML = msg
            document.body.appendChild(elem)
        }

        // register and get from https://streamr.network/signup
        const STREAM_ID = '0xa3d1f77acff0060f7213d7bf3c7fec78df847de1/sam1'

        // Create the client and give the API key to use by default
        const client = new StreamrClient({
        // ganache 1: 0x4178baBE9E5148c6D5fd431cD72884B07Ad855a0
        auth: {
            privateKey: '0x5e98cce00cff5dea6b454889f359a4ec06b9fa6b88e9d69b86de8e1c81887da0',
        },
        url: `ws://localhost/api/v1/ws`,
        restUrl: `http://localhost/api/v1`,
        streamrNodeAddress: '0xFCAd0B19bB29D4674531d6f115237E16AfCE377c',
        tokenAddress:  '0xbAA81A0179015bE47Ad439566374F2Bae098686F',
        tokenSidechainAddress:  '0x73Be21733CC5D08e1a14Ea9a399fb27DB3BEf8fF',
        dataUnion: {
            factoryMainnetAddress:  '0x4bbcBeFBEC587f6C4AF9AF9B48847caEa1Fe81dA',
            factorySidechainAddress:  '0x4A4c4759eb3b7ABee079f832850cD3D0dC48D927',
            templateMainnetAddress:  '0x7bFBAe10AE5b5eF45e2aC396E0E605F6658eF3Bc',
            templateSidechainAddress:  '0x36afc8c9283CC866b8EB6a61C6e6862a83cd6ee8',
        },
        storageNode: {
            address: '0xde1112f631486CfC759A50196853011528bC5FA0',
            url: `http://10.200.10.1:8891`
        },
        sidechain: {
            url: `http://10.200.10.1:8546`,
            timeout: 100000000000,
        },
        mainnet: {
            url: `http://10.200.10.1:8545`,
            timeout: 100000000000,
        },
        autoConnect: true,
        autoDisconnect: false,
    })

        function publish() {
            // Here is the event we'll be sending
            

            // Publish the event to the Stream
            setInterval(function() {
                const msg = {
                hello: 'world',
                random: Math.random()
            }
                client.publish(STREAM_ID, msg)
                .then(() => console.log('Sent successfully: ', msg))
                .catch((err) => log(err))
            }, 1000)
        }
    </script>
</head>
<body>
    <button id="publish">Publish</button>
    <script>
        document.getElementById('publish').addEventListener('click', publish)
    </script>
</body>
</html>
